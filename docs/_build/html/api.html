

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; SOLWEIG-GPU 1.2.15 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=4afb903a"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Input Data" href="input_data.html" />
    <link rel="prev" title="Quick Start Guide" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SOLWEIG-GPU
              <img src="_static/logo.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#using-conda-recommended">Using Conda (Recommended)</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#using-pip-with-system-gdal">Using pip with system GDAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#development-installation">Development Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#verify-installation">Verify Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#gpu-setup">GPU Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#cuda-requirements">CUDA Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#cpu-only-mode">CPU-Only Mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#common-issues">Common Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#gdal-import-error">GDAL Import Error</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#pytorch-gpu-not-detected">PyTorch GPU Not Detected</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#basic-workflow">Basic Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#example-1-using-your-own-met-data">Example 1: Using Your Own Met Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#required-input-files">Required Input Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#met-data-format">Met Data Format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#example-2-using-era5-data">Example 2: Using ERA5 Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#example-3-using-wrf-output">Example 3: Using WRF Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#command-line-usage">Command-Line Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#configuration-options">Configuration Options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#tile-size">Tile Size</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#output-options">Output Options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#output-files">Output Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-solweig_gpu.solweig_gpu">Main Entry Point</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig_gpu.thermal_comfort"><code class="docutils literal notranslate"><span class="pre">thermal_comfort()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-solweig_gpu.preprocessor">Data Preprocessing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.preprocessor.extract_datetime_strict"><code class="docutils literal notranslate"><span class="pre">extract_datetime_strict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.preprocessor.check_rasters"><code class="docutils literal notranslate"><span class="pre">check_rasters()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.preprocessor.create_tiles"><code class="docutils literal notranslate"><span class="pre">create_tiles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.preprocessor.process_era5_data"><code class="docutils literal notranslate"><span class="pre">process_era5_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.preprocessor.process_wrfout_data"><code class="docutils literal notranslate"><span class="pre">process_wrfout_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.preprocessor.process_metfiles"><code class="docutils literal notranslate"><span class="pre">process_metfiles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.preprocessor.create_met_files"><code class="docutils literal notranslate"><span class="pre">create_met_files()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.preprocessor.ppr"><code class="docutils literal notranslate"><span class="pre">ppr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-solweig_gpu.solweig">Radiation Calculations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.ensure_tensor"><code class="docutils literal notranslate"><span class="pre">ensure_tensor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.daylen"><code class="docutils literal notranslate"><span class="pre">daylen()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.sunonsurface_2018a"><code class="docutils literal notranslate"><span class="pre">sunonsurface_2018a()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.gvf_2018a"><code class="docutils literal notranslate"><span class="pre">gvf_2018a()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.cylindric_wedge"><code class="docutils literal notranslate"><span class="pre">cylindric_wedge()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.TsWaveDelay_2015a"><code class="docutils literal notranslate"><span class="pre">TsWaveDelay_2015a()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.Kup_veg_2015a"><code class="docutils literal notranslate"><span class="pre">Kup_veg_2015a()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.Kvikt_veg"><code class="docutils literal notranslate"><span class="pre">Kvikt_veg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.shaded_or_sunlit"><code class="docutils literal notranslate"><span class="pre">shaded_or_sunlit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.Kside_veg_v2022a"><code class="docutils literal notranslate"><span class="pre">Kside_veg_v2022a()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.sun_distance"><code class="docutils literal notranslate"><span class="pre">sun_distance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.clearnessindex_2013b"><code class="docutils literal notranslate"><span class="pre">clearnessindex_2013b()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.diffusefraction"><code class="docutils literal notranslate"><span class="pre">diffusefraction()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.shadowingfunction_wallheight_13"><code class="docutils literal notranslate"><span class="pre">shadowingfunction_wallheight_13()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.shadowingfunction_wallheight_23"><code class="docutils literal notranslate"><span class="pre">shadowingfunction_wallheight_23()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.Perez_v3"><code class="docutils literal notranslate"><span class="pre">Perez_v3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.model1"><code class="docutils literal notranslate"><span class="pre">model1()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.model2"><code class="docutils literal notranslate"><span class="pre">model2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.model3"><code class="docutils literal notranslate"><span class="pre">model3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.define_patch_characteristics"><code class="docutils literal notranslate"><span class="pre">define_patch_characteristics()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.Lcyl_v2022a"><code class="docutils literal notranslate"><span class="pre">Lcyl_v2022a()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.Lvikt_veg"><code class="docutils literal notranslate"><span class="pre">Lvikt_veg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.Lside_veg_v2022a"><code class="docutils literal notranslate"><span class="pre">Lside_veg_v2022a()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.solweig.Solweig_2022a_calc"><code class="docutils literal notranslate"><span class="pre">Solweig_2022a_calc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-solweig_gpu.sun_position">Solar Position Algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.sun_position"><code class="docutils literal notranslate"><span class="pre">sun_position()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.julian_calculation"><code class="docutils literal notranslate"><span class="pre">julian_calculation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.earth_heliocentric_position_calculation"><code class="docutils literal notranslate"><span class="pre">earth_heliocentric_position_calculation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.sun_geocentric_position_calculation"><code class="docutils literal notranslate"><span class="pre">sun_geocentric_position_calculation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.nutation_calculation"><code class="docutils literal notranslate"><span class="pre">nutation_calculation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.true_obliquity_calculation"><code class="docutils literal notranslate"><span class="pre">true_obliquity_calculation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.abberation_correction_calculation"><code class="docutils literal notranslate"><span class="pre">abberation_correction_calculation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.apparent_sun_longitude_calculation"><code class="docutils literal notranslate"><span class="pre">apparent_sun_longitude_calculation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.apparent_stime_at_greenwich_calculation"><code class="docutils literal notranslate"><span class="pre">apparent_stime_at_greenwich_calculation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.sun_rigth_ascension_calculation"><code class="docutils literal notranslate"><span class="pre">sun_rigth_ascension_calculation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.sun_geocentric_declination_calculation"><code class="docutils literal notranslate"><span class="pre">sun_geocentric_declination_calculation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.observer_local_hour_calculation"><code class="docutils literal notranslate"><span class="pre">observer_local_hour_calculation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.topocentric_sun_position_calculate"><code class="docutils literal notranslate"><span class="pre">topocentric_sun_position_calculate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.topocentric_local_hour_calculate"><code class="docutils literal notranslate"><span class="pre">topocentric_local_hour_calculate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.sun_topocentric_zenith_angle_calculate"><code class="docutils literal notranslate"><span class="pre">sun_topocentric_zenith_angle_calculate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.set_to_range"><code class="docutils literal notranslate"><span class="pre">set_to_range()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.sun_position.Solweig_2015a_metdata_noload"><code class="docutils literal notranslate"><span class="pre">Solweig_2015a_metdata_noload()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-solweig_gpu.shadow">Shadow and Sky View Factor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.shadow.ensure_tensor"><code class="docutils literal notranslate"><span class="pre">ensure_tensor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.shadow.shadow"><code class="docutils literal notranslate"><span class="pre">shadow()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.shadow.annulus_weight"><code class="docutils literal notranslate"><span class="pre">annulus_weight()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.shadow.create_patches"><code class="docutils literal notranslate"><span class="pre">create_patches()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.shadow.svf_calculator"><code class="docutils literal notranslate"><span class="pre">svf_calculator()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-solweig_gpu.calculate_utci">UTCI Calculations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.calculate_utci.utci_polynomial"><code class="docutils literal notranslate"><span class="pre">utci_polynomial()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.calculate_utci.utci_calculator"><code class="docutils literal notranslate"><span class="pre">utci_calculator()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-solweig_gpu.utci_process">UTCI Processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.utci_process.load_raster_to_tensor"><code class="docutils literal notranslate"><span class="pre">load_raster_to_tensor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.utci_process.extract_key"><code class="docutils literal notranslate"><span class="pre">extract_key()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.utci_process.get_matching_files"><code class="docutils literal notranslate"><span class="pre">get_matching_files()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.utci_process.map_files_by_key"><code class="docutils literal notranslate"><span class="pre">map_files_by_key()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.utci_process.extract_number_from_filename"><code class="docutils literal notranslate"><span class="pre">extract_number_from_filename()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.utci_process.compute_utci"><code class="docutils literal notranslate"><span class="pre">compute_utci()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-solweig_gpu.walls_aspect">Wall Geometry</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.walls_aspect.findwalls"><code class="docutils literal notranslate"><span class="pre">findwalls()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.walls_aspect.cart2pol"><code class="docutils literal notranslate"><span class="pre">cart2pol()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.walls_aspect.get_ders"><code class="docutils literal notranslate"><span class="pre">get_ders()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.walls_aspect.filter1Goodwin_as_aspect_v3"><code class="docutils literal notranslate"><span class="pre">filter1Goodwin_as_aspect_v3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.walls_aspect.process_file_parallel"><code class="docutils literal notranslate"><span class="pre">process_file_parallel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.walls_aspect.run_parallel_processing"><code class="docutils literal notranslate"><span class="pre">run_parallel_processing()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-solweig_gpu.cli">Command-Line Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.cli.str2bool"><code class="docutils literal notranslate"><span class="pre">str2bool()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.cli.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-solweig_gpu.Tgmaps_v1">Surface Properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solweig_gpu.Tgmaps_v1.Tgmaps_v1"><code class="docutils literal notranslate"><span class="pre">Tgmaps_v1()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="input_data.html">Input Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="input_data.html#geospatial-rasters">Geospatial Rasters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input_data.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="input_data.html#required-rasters">Required Rasters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input_data.html#building-dsm">Building DSM</a></li>
<li class="toctree-l4"><a class="reference internal" href="input_data.html#digital-elevation-model-dem">Digital Elevation Model (DEM)</a></li>
<li class="toctree-l4"><a class="reference internal" href="input_data.html#tree-dsm">Tree DSM</a></li>
<li class="toctree-l4"><a class="reference internal" href="input_data.html#land-cover-optional">Land Cover (Optional)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input_data.html#meteorological-forcing-data">Meteorological Forcing Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input_data.html#option-1-custom-text-file-umep-format">Option 1: Custom Text File (UMEP Format)</a></li>
<li class="toctree-l3"><a class="reference internal" href="input_data.html#option-2-era5-reanalysis-data">Option 2: ERA5 Reanalysis Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="input_data.html#option-3-wrf-output-files">Option 3: WRF Output Files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input_data.html#data-preparation-tips">Data Preparation Tips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input_data.html#coordinate-reference-system">Coordinate Reference System</a></li>
<li class="toctree-l3"><a class="reference internal" href="input_data.html#temporal-resolution">Temporal Resolution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input_data.html#sample-data">Sample Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#basic-configuration">Basic Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#required-parameters">Required Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="configuration.html#base-path"><code class="docutils literal notranslate"><span class="pre">base_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="configuration.html#selected-date-str"><code class="docutils literal notranslate"><span class="pre">selected_date_str</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#raster-filenames">Raster Filenames</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#tiling-configuration">Tiling Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#tile-size"><code class="docutils literal notranslate"><span class="pre">tile_size</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#overlap"><code class="docutils literal notranslate"><span class="pre">overlap</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#meteorological-data-configuration">Meteorological Data Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#using-custom-meteorological-file">Using Custom Meteorological File</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#using-era5-or-wrf-data">Using ERA5 or WRF Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#output-configuration">Output Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#complete-configuration-example">Complete Configuration Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#performance-optimization">Performance Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#gpu-vs-cpu">GPU vs CPU</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#memory-management">Memory Management</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="outputs.html">Outputs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="outputs.html#output-structure">Output Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="outputs.html#output-files">Output Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#universal-thermal-climate-index-utci">Universal Thermal Climate Index (UTCI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#mean-radiant-temperature-tmrt">Mean Radiant Temperature (Tmrt)</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#sky-view-factor-svf">Sky View Factor (SVF)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="outputs.html#downwelling-shortwave">Downwelling Shortwave</a></li>
<li class="toctree-l4"><a class="reference internal" href="outputs.html#upwelling-shortwave-kup">Upwelling Shortwave (Kup)</a></li>
<li class="toctree-l4"><a class="reference internal" href="outputs.html#downwelling-longwave-ldown">Downwelling Longwave (Ldown)</a></li>
<li class="toctree-l4"><a class="reference internal" href="outputs.html#upwelling-longwave-lup">Upwelling Longwave (Lup)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#shadow-maps">Shadow Maps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="outputs.html#multi-band-structure">Multi-Band Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="outputs.html#visualizing-outputs">Visualizing Outputs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#using-qgis">Using QGIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#using-python">Using Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#using-arcgis">Using ArcGIS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="outputs.html#merging-tiles">Merging Tiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#utci-tile-merging-example">UTCI tile merging example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="outputs.html#data-analysis">Data Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#computing-statistics">Computing Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#extracting-time-series">Extracting Time Series</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Example Notebooks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="notebooks.html#example-1-using-your-own-met-file">Example 1: Using Your Own Met File</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="notebooks.html#example-2-using-era5-data">Example 2: Using ERA5 Data</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="notebooks.html#example-3-using-wrf-output">Example 3: Using WRF Output</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="notebooks.html#download-all-notebooks">Download All Notebooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples.html#example-1-using-wrf-data">Example 1: Using WRF Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#example-2-using-era5-data">Example 2: Using ERA5 Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#you-can-download-era5-as-below">You can download ERA5 as below</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#example-3-using-a-custom-meteorological-file">Example 3: Using a Custom Meteorological File</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="testing.html#running-tests">Running Tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="testing.html#full-test-suite">Full Test Suite</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#with-coverage-report">With Coverage Report</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#specific-test-modules">Specific Test Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#example-testing-a-utility-function">Example: Testing a Utility Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#example-testing-with-fixtures">Example: Testing with Fixtures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="testing.html#continuous-integration">Continuous Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html#manual-testing">Manual Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="testing.html#test-with-sample-data">Test with Sample Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#verify-outputs">Verify Outputs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="testing.html#benchmark-tests">Benchmark Tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="developer_guide.html">Developer Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="developer_guide.html#architecture-overview">Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_guide.html#module-interactions">Module Interactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_guide.html#contributing-to-solweig-gpu">Contributing to SOLWEIG-GPU</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SOLWEIG-GPU</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading"></a></h1>
<p>This page contains the complete API reference for SOLWEIG-GPU, auto-generated from docstrings.</p>
<section id="module-solweig_gpu.solweig_gpu">
<span id="main-entry-point"></span><h2>Main Entry Point<a class="headerlink" href="#module-solweig_gpu.solweig_gpu" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig_gpu.thermal_comfort">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig_gpu.</span></span><span class="sig-name descname"><span class="pre">thermal_comfort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_date_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">building_dsm_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Building_DSM.tif'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dem_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'DEM.tif'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trees_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Trees.tif'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landcover_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_own_met</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_source_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">own_met_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_tmrt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_svf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_kup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_kdown</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_lup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_ldown</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_shadow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig_gpu.html#thermal_comfort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig_gpu.thermal_comfort" title="Link to this definition"></a></dt>
<dd><p>Main function to compute urban thermal comfort using the SOLWEIG-GPU model.</p>
<p>This function orchestrates the complete workflow:
1. Preprocesses input rasters (tiling, validation)
2. Processes meteorological data (ERA5, WRF, or custom)
3. Calculates wall heights and aspects (parallel CPU)
4. Computes shadows, radiation, and SVF (GPU-accelerated)
5. Calculates UTCI thermal comfort index
6. Saves outputs as georeferenced rasters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Base directory containing input rasters</p></li>
<li><p><strong>selected_date_str</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Simulation date in format ‘YYYY-MM-DD’</p></li>
<li><p><strong>building_dsm_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Building+terrain DSM filename. Default: ‘Building_DSM.tif’</p></li>
<li><p><strong>dem_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Digital Elevation Model filename. Default: ‘DEM.tif’</p></li>
<li><p><strong>trees_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Vegetation DSM filename. Default: ‘Trees.tif’</p></li>
<li><p><strong>landcover_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Land cover raster filename. Default: None</p></li>
<li><p><strong>tile_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Tile size in pixels. Default: 3600. Adjust based on GPU RAM.</p></li>
<li><p><strong>overlap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Overlap between tiles in pixels. Default: 20. Used for shadow transfer.</p></li>
<li><p><strong>use_own_met</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Use custom meteorological file. Default: True</p></li>
<li><p><strong>start_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Start datetime ‘YYYY-MM-DD HH:MM:SS’ (UTC for ERA5/WRF)</p></li>
<li><p><strong>end_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – End datetime ‘YYYY-MM-DD HH:MM:SS’ (UTC for ERA5/WRF)</p></li>
<li><p><strong>data_source_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – ‘ERA5’ or ‘wrfout’ if not using own met file</p></li>
<li><p><strong>data_folder</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Folder containing ERA5/WRF NetCDF files</p></li>
<li><p><strong>own_met_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Path to custom meteorological text file</p></li>
<li><p><strong>save_tmrt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Save mean radiant temperature output. Default: True</p></li>
<li><p><strong>save_svf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Save sky view factor output. Default: False</p></li>
<li><p><strong>save_kup</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Save upward shortwave radiation. Default: False</p></li>
<li><p><strong>save_kdown</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Save downward shortwave radiation. Default: False</p></li>
<li><p><strong>save_lup</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Save upward longwave radiation. Default: False</p></li>
<li><p><strong>save_ldown</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Save downward longwave radiation. Default: False</p></li>
<li><p><strong>save_shadow</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Save shadow maps. Default: False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Outputs are saved to <cite>{base_path}/Outputs/</cite> directory</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<dl class="simple">
<dt>Output Structure:</dt><dd><ul class="simple">
<li><p>Outputs/{tile_key}/ - One folder per tile
- UTCI_{date}.tif - Universal Thermal Climate Index (always saved)
- Tmrt_{date}.tif - Mean radiant temperature (if save_tmrt=True)
- SVF.tif - Sky view factor (if save_svf=True)
- Kup_{date}.tif - Upward shortwave (if save_kup=True)
- Kdown_{date}.tif - Downward shortwave (if save_kdown=True)
- Lup_{date}.tif - Upward longwave (if save_lup=True)
- Ldown_{date}.tif - Downward longwave (if save_ldown=True)
- Shadow_{date}.tif - Shadow maps (if save_shadow=True)</p></li>
</ul>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<ul class="simple">
<li><p>Automatically uses GPU if available, falls back to CPU</p></li>
<li><p>Processes tiles in parallel for large domains</p></li>
<li><p>UTC to local time conversion handled automatically</p></li>
<li><p>Multi-band rasters: one band per hour</p></li>
</ul>
</div>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">solweig_gpu</span><span class="w"> </span><span class="kn">import</span> <span class="n">thermal_comfort</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thermal_comfort</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">base_path</span><span class="o">=</span><span class="s1">&#39;/path/to/input&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">selected_date_str</span><span class="o">=</span><span class="s1">&#39;2020-08-13&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tile_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">overlap</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">use_own_met</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">own_met_file</span><span class="o">=</span><span class="s1">&#39;/path/to/met.txt&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If input rasters have mismatched dimensions, CRS, or pixel sizes</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.14)"><strong>FileNotFoundError</strong></a> – If required input files are missing</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>landcover_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><em>None</em>)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-solweig_gpu.preprocessor">
<span id="data-preprocessing"></span><h2>Data Preprocessing<a class="headerlink" href="#module-solweig_gpu.preprocessor" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.preprocessor.extract_datetime_strict">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.preprocessor.</span></span><span class="sig-name descname"><span class="pre">extract_datetime_strict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/preprocessor.html#extract_datetime_strict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.preprocessor.extract_datetime_strict" title="Link to this definition"></a></dt>
<dd><p>Return (datetime, domain_int) for strictly valid wrfout names.
Raises ValueError for any non-matching filename.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.preprocessor.check_rasters">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.preprocessor.</span></span><span class="sig-name descname"><span class="pre">check_rasters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">files</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/preprocessor.html#check_rasters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.preprocessor.check_rasters" title="Link to this definition"></a></dt>
<dd><p>Check that all provided raster files have matching dimensions, pixel size, and CRS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>files</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a>) – List of raster file paths.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if all checks pass, raises ValueError/FileNotFoundError otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.preprocessor.create_tiles">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.preprocessor.</span></span><span class="sig-name descname"><span class="pre">create_tiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tilesize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/preprocessor.html#create_tiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.preprocessor.create_tiles" title="Link to this definition"></a></dt>
<dd><p>Tile a raster file into smaller chunks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infile</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to input raster.</p></li>
<li><p><strong>tilesize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Size of each tile in pixels.</p></li>
<li><p><strong>overlap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of pixels to overlap between tiles.</p></li>
<li><p><strong>tile_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Label to use for naming output tiles.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.14)"><strong>FileNotFoundError</strong></a> – If the input file is not found.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If the overlap is not within the valid range.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.preprocessor.process_era5_data">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.preprocessor.</span></span><span class="sig-name descname"><span class="pre">process_era5_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Outfile.nc'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/preprocessor.html#process_era5_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.preprocessor.process_era5_data" title="Link to this definition"></a></dt>
<dd><p>Same numeric outputs as your original function, but time is taken from the files
and sliced to [start_time, end_time] UTC. Variables written:</p>
<blockquote>
<div><p>T2 (t2m, Kelvin), PSFC (sp, Pa), RH2 (%), WIND (m/s), SWDOWN (W/m^2 = ssrd/3600).</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.preprocessor.process_wrfout_data">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.preprocessor.</span></span><span class="sig-name descname"><span class="pre">process_wrfout_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Outfile.nc'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/preprocessor.html#process_wrfout_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.preprocessor.process_wrfout_data" title="Link to this definition"></a></dt>
<dd><p>Process WRF output files to create meteorological forcing data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Start datetime string in format “%Y-%m-%d %H:%M:%S”.</p></li>
<li><p><strong>end_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – End datetime string in format “%Y-%m-%d %H:%M:%S”.</p></li>
<li><p><strong>folder_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Directory containing wrfout files.</p></li>
<li><p><strong>output_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Output NetCDF file name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.preprocessor.process_metfiles">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.preprocessor.</span></span><span class="sig-name descname"><span class="pre">process_metfiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">netcdf_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raster_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_date_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/preprocessor.html#process_metfiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.preprocessor.process_metfiles" title="Link to this definition"></a></dt>
<dd><p>Minimal-edits, curvilinear-safe version of your function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.preprocessor.create_met_files">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.preprocessor.</span></span><span class="sig-name descname"><span class="pre">create_met_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_met_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/preprocessor.html#create_met_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.preprocessor.create_met_files" title="Link to this definition"></a></dt>
<dd><p>Copy a given met file to multiple outputs based on the raster tile filenames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Base directory containing “Building_DSM” and where to create “metfiles”.</p></li>
<li><p><strong>source_met_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to user-provided met file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.preprocessor.ppr">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.preprocessor.</span></span><span class="sig-name descname"><span class="pre">ppr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">building_dsm_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dem_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trees_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landcover_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_date_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_own_met</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_source_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">own_met_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/preprocessor.html#ppr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.preprocessor.ppr" title="Link to this definition"></a></dt>
<dd><p>Preprocessing routine to validate raster files, generate tiles, and prepare metfiles for SOLWEIG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Base working directory.</p></li>
<li><p><strong>building_dsm_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Filename of building DSM raster.</p></li>
<li><p><strong>dem_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Filename of DEM raster.</p></li>
<li><p><strong>trees_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Filename of trees raster.</p></li>
<li><p><strong>landcover_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Filename of landcover raster or None.</p></li>
<li><p><strong>tile_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Tile size in pixels.</p></li>
<li><p><strong>overlap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Overlap between tiles in pixels.</p></li>
<li><p><strong>selected_date_str</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Selected date (YYYY-MM-DD).</p></li>
<li><p><strong>use_own_met</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to use a user-provided met file.</p></li>
<li><p><strong>start_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Start datetime (required if not using own met file).</p></li>
<li><p><strong>end_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – End datetime (required if not using own met file).</p></li>
<li><p><strong>data_source_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Either ‘ERA5’ or ‘wrfout’.</p></li>
<li><p><strong>data_folder</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Folder containing input NetCDF files.</p></li>
<li><p><strong>own_met_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to user-provided met file (used if use_own_met is True).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-solweig_gpu.solweig">
<span id="radiation-calculations"></span><h2>Radiation Calculations<a class="headerlink" href="#module-solweig_gpu.solweig" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.ensure_tensor">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">ensure_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#ensure_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.ensure_tensor" title="Link to this definition"></a></dt>
<dd><p>Convert input to PyTorch tensor on specified device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Input data (numpy array, list, or tensor)</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><em>torch.device</em></a><em>, </em><em>optional</em>) – Target device</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Input as tensor on device</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.daylen">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">daylen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">DOY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">XLAT</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#daylen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.daylen" title="Link to this definition"></a></dt>
<dd><p>Calculate day length and solar declination for given day and latitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DOY</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Day of year (1-365)</p></li>
<li><p><strong>XLAT</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Latitude in degrees</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(DAYL, DEC, SNDN, SNUP) where:</dt><dd><ul class="simple">
<li><p>DAYL: Day length in hours</p></li>
<li><p>DEC: Solar declination in degrees</p></li>
<li><p>SNDN: Time of solar noon in hours</p></li>
<li><p>SNUP: Time of sunrise in hours</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.sunonsurface_2018a">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">sunonsurface_2018a</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">azimuthA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buildings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shadow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sunwall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">walls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tgwall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emis_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ewall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alb_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SBC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">albedo_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Twater</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landcover</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#sunonsurface_2018a"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.sunonsurface_2018a" title="Link to this definition"></a></dt>
<dd><p>Calculate solar radiation on surfaces with different orientations.</p>
<p>Determines radiation on walls and ground surfaces accounting for
building geometry, shadows, and surface properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>azimuthA</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Solar azimuth angle (degrees)</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Grid scale (pixels per meter)</p></li>
<li><p><strong>buildings</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Building mask array</p></li>
<li><p><strong>shadow</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow map</p></li>
<li><p><strong>sunwall</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Sunlit wall mask</p></li>
<li><p><strong>first</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – First surface type</p></li>
<li><p><strong>second</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Second surface type</p></li>
<li><p><strong>aspect</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Wall aspect angles</p></li>
<li><p><strong>walls</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Wall heights</p></li>
<li><p><strong>Tg</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Ground temperature</p></li>
<li><p><strong>Tgwall</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Wall temperature</p></li>
<li><p><strong>Ta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Air temperature</p></li>
<li><p><strong>emis_grid</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Ground emissivity</p></li>
<li><p><strong>ewall</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Wall emissivity</p></li>
<li><p><strong>alb_grid</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Ground albedo</p></li>
<li><p><strong>SBC</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Stefan-Boltzmann constant</p></li>
<li><p><strong>albedo_b</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Building albedo</p></li>
<li><p><strong>Twater</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Water temperature</p></li>
<li><p><strong>lc_grid</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Land cover grid</p></li>
<li><p><strong>landcover</strong> (<em>np.ndarray</em>) – Land cover classification</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Radiation components for different surfaces</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.gvf_2018a">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">gvf_2018a</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wallsun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">walls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buildings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shadow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirwalls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tgwall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emis_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ewall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alb_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SBC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">albedo_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Twater</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landcover</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#gvf_2018a"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.gvf_2018a" title="Link to this definition"></a></dt>
<dd><p>Calculate ground view factors for radiation exchange between surfaces.</p>
<p>Computes how much ground surfaces “see” walls and other surfaces,
accounting for shadows and multiple reflections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wallsun</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Sunlit wall indicator</p></li>
<li><p><strong>walls</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Wall heights</p></li>
<li><p><strong>buildings</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Building mask</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Grid scale</p></li>
<li><p><strong>shadow</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow map</p></li>
<li><p><strong>first/second</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Surface classification</p></li>
<li><p><strong>dirwalls</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Wall directions</p></li>
<li><p><strong>Tg/Tgwall/Ta</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Temperatures (ground/wall/air)</p></li>
<li><p><strong>emis_grid</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Ground emissivity</p></li>
<li><p><strong>ewall</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Wall emissivity</p></li>
<li><p><strong>alb_grid</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Ground albedo</p></li>
<li><p><strong>SBC</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Stefan-Boltzmann constant</p></li>
<li><p><strong>albedo_b</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Building albedo</p></li>
<li><p><strong>rows/cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Grid dimensions</p></li>
<li><p><strong>Twater</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Water temperature</p></li>
<li><p><strong>lc_grid</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Land cover grid</p></li>
<li><p><strong>landcover</strong> (<em>np.ndarray</em>) – Land cover data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>View factors and albedo components for different directions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.cylindric_wedge">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">cylindric_wedge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfalfa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#cylindric_wedge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.cylindric_wedge" title="Link to this definition"></a></dt>
<dd><p>Calculate form factors for cylindrical geometry (human body model).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zen</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Solar zenith angle</p></li>
<li><p><strong>svfalfa</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – SVF alpha component</p></li>
<li><p><strong>rows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Grid dimensions</p></li>
<li><p><strong>cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Grid dimensions</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(Fside, Fup, Fcyl) - Form factors for cylinder sides, top, and total</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.TsWaveDelay_2015a">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">TsWaveDelay_2015a</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gvfLup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">firstdaytime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeadd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestepdec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tgmap1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#TsWaveDelay_2015a"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.TsWaveDelay_2015a" title="Link to this definition"></a></dt>
<dd><p>Calculate surface temperature wave delay.</p>
<p>Models thermal inertia and temperature wave propagation in surfaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gvfLup</strong> – Ground view factor for upward longwave</p></li>
<li><p><strong>firstdaytime</strong> – First time step flag</p></li>
<li><p><strong>timeadd</strong> – Time addition parameter</p></li>
<li><p><strong>timestepdec</strong> – Time step decimal</p></li>
<li><p><strong>Tgmap1</strong> – Previous ground temperature map</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Temperature with wave delay applied</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.Kup_veg_2015a">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">Kup_veg_2015a</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radD</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfbuveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">albedo_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gvfalb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gvfalbE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gvfalbS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gvfalbW</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gvfalbN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gvfalbnosh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gvfalbnoshE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gvfalbnoshS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gvfalbnoshW</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gvfalbnoshN</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#Kup_veg_2015a"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.Kup_veg_2015a" title="Link to this definition"></a></dt>
<dd><p>Calculate upward shortwave radiation with vegetation effects.</p>
<p>Accounts for multiple reflections between ground, walls, and vegetation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Upward shortwave components for different directions</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.Kvikt_veg">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">Kvikt_veg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">svf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vikttot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#Kvikt_veg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.Kvikt_veg" title="Link to this definition"></a></dt>
<dd><p>Calculate shortwave weight factor accounting for vegetation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.shaded_or_sunlit">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">shaded_or_sunlit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solar_altitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solar_azimuth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_altitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_azimuth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asvf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#shaded_or_sunlit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.shaded_or_sunlit" title="Link to this definition"></a></dt>
<dd><p>Determine if sky patches are shaded or sunlit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solar_altitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Solar altitude angle</p></li>
<li><p><strong>solar_azimuth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Solar azimuth angle</p></li>
<li><p><strong>patch_altitude</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Patch altitude angles</p></li>
<li><p><strong>patch_azimuth</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Patch azimuth angles</p></li>
<li><p><strong>asvf</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Anisotropic sky view factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Binary mask (1=sunlit, 0=shaded)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.Kside_veg_v2022a">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">Kside_veg_v2022a</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radD</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shadow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfW</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfEveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfSveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfWveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfNveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azimuth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">albedo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">KupE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">KupS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">KupW</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">KupN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cyl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anisotropic_diffuse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffsh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asvf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vegshmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbshvegshmat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#Kside_veg_v2022a"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.Kside_veg_v2022a" title="Link to this definition"></a></dt>
<dd><p>Calculate shortwave radiation on vertical surfaces (walls) with vegetation effects.</p>
<p>Computes direct, diffuse, and reflected shortwave radiation on walls in the
four cardinal directions, accounting for vegetation shading and ground reflections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radI</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Direct, diffuse, and global radiation (W/m²)</p></li>
<li><p><strong>radD</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Direct, diffuse, and global radiation (W/m²)</p></li>
<li><p><strong>radG</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Direct, diffuse, and global radiation (W/m²)</p></li>
<li><p><strong>shadow</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow map</p></li>
<li><p><strong>svfS</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Directional sky view factors</p></li>
<li><p><strong>svfW</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Directional sky view factors</p></li>
<li><p><strong>svfN</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Directional sky view factors</p></li>
<li><p><strong>svfE</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Directional sky view factors</p></li>
<li><p><strong>svf*veg</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Vegetation-obstructed SVFs</p></li>
<li><p><strong>azimuth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Solar angles (degrees)</p></li>
<li><p><strong>altitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Solar angles (degrees)</p></li>
<li><p><strong>psi</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Tilt angles</p></li>
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Transmissivity factor</p></li>
<li><p><strong>albedo</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Surface albedo</p></li>
<li><p><strong>F_sh</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Form factor</p></li>
<li><p><strong>KupE</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Upward shortwave per direction</p></li>
<li><p><strong>KupS</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Upward shortwave per direction</p></li>
<li><p><strong>KupW</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Upward shortwave per direction</p></li>
<li><p><strong>KupN</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Upward shortwave per direction</p></li>
<li><p><strong>cyl</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Cylindrical geometry factor</p></li>
<li><p><strong>lv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Leaf area index factor</p></li>
<li><p><strong>anisotropic_diffuse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Use anisotropic diffuse model</p></li>
<li><p><strong>diffsh</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Diffuse shadowing</p></li>
<li><p><strong>rows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Grid dimensions</p></li>
<li><p><strong>cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Grid dimensions</p></li>
<li><p><strong>asvf</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Anisotropic SVF</p></li>
<li><p><strong>shmat</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow matrices</p></li>
<li><p><strong>vegshmat</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow matrices</p></li>
<li><p><strong>vbshvegshmat</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow matrices</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(Keast, Ksouth, Kwest, Knorth, KsideI, KsideD, Kside) -</dt><dd><p>Shortwave radiation components for each direction</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.sun_distance">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">sun_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jday</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#sun_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.sun_distance" title="Link to this definition"></a></dt>
<dd><p>Calculate Earth-Sun distance correction factor for given day.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>jday</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Julian day of year</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Distance correction factor (dimensionless)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.clearnessindex_2013b">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">clearnessindex_2013b</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jday</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RH</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#clearnessindex_2013b"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.clearnessindex_2013b" title="Link to this definition"></a></dt>
<dd><p>Calculate atmospheric clearness index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zen</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Solar zenith angle (radians)</p></li>
<li><p><strong>jday</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Julian day</p></li>
<li><p><strong>Ta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Air temperature (°C)</p></li>
<li><p><strong>RH</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Relative humidity (%)</p></li>
<li><p><strong>radG</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Global radiation (W/m²)</p></li>
<li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Geographic location</p></li>
<li><p><strong>P</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Atmospheric pressure (kPa)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Clearness index (dimensionless, 0-1)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.diffusefraction">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">diffusefraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Kt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RH</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#diffusefraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.diffusefraction" title="Link to this definition"></a></dt>
<dd><p>Calculate fraction of diffuse radiation from global radiation.</p>
<p>Uses empirical models to partition global radiation into direct and diffuse components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radG</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Global horizontal radiation (W/m²)</p></li>
<li><p><strong>altitude</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Solar altitude (degrees)</p></li>
<li><p><strong>Kt</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Clearness index</p></li>
<li><p><strong>Ta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Air temperature (°C)</p></li>
<li><p><strong>RH</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Relative humidity (%)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(radD, radI) where:</dt><dd><ul class="simple">
<li><p>radD: Diffuse radiation (W/m²)</p></li>
<li><p>radI: Direct beam radiation (W/m²)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.shadowingfunction_wallheight_13">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">shadowingfunction_wallheight_13</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azimuth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">walls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#shadowingfunction_wallheight_13"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.shadowingfunction_wallheight_13" title="Link to this definition"></a></dt>
<dd><p>Calculate shadow patterns accounting for wall heights (method 1.3).</p>
<p>Determines which surfaces are in shadow cast by nearby walls based on
solar angle, wall height, and wall orientation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(vegsh, sh, vbshvegsh, wallsh, wallsun, wallshve, facesh, facesun)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.shadowingfunction_wallheight_23">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">shadowingfunction_wallheight_23</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vegdem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vegdem2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azimuth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amaxvalue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bush</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">walls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#shadowingfunction_wallheight_23"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.shadowingfunction_wallheight_23" title="Link to this definition"></a></dt>
<dd><p>Calculate shadow patterns with vegetation and wall heights (method 2.3).</p>
<p>Extended shadow calculation including vegetation layers and building walls.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Shadow components including vegetation effects</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.Perez_v3">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">Perez_v3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azimuth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radD</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jday</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patchchoice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_option</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#Perez_v3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.Perez_v3" title="Link to this definition"></a></dt>
<dd><p>Calculate anisotropic diffuse radiation distribution using Perez model.</p>
<p>Implements the Perez all-weather sky model for anisotropic diffuse radiation,
accounting for circumsolar brightening and horizon brightening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zen</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Solar zenith angle (radians)</p></li>
<li><p><strong>azimuth</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Solar azimuth (radians)</p></li>
<li><p><strong>radD</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Diffuse radiation (W/m²)</p></li>
<li><p><strong>radI</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Direct beam radiation (W/m²)</p></li>
<li><p><strong>jday</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Julian day</p></li>
<li><p><strong>patchchoice</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Patch selection</p></li>
<li><p><strong>patch_option</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Sky discretization (144 or 2304)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Patch-wise diffuse radiation distribution and anisotropic SVF</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p>Perez et al. (1993). All-weather model for sky luminance distribution.
Solar Energy, 50(3), 235-245.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.model1">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">model1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sky_patches</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esky</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#model1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.model1" title="Link to this definition"></a></dt>
<dd><p>Calculate longwave sky radiation using Model 1 (isotropic).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.model2">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">model2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sky_patches</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esky</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#model2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.model2" title="Link to this definition"></a></dt>
<dd><p>Calculate longwave sky radiation using Model 2 (simple anisotropic).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.model3">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">model3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sky_patches</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esky</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#model3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.model3" title="Link to this definition"></a></dt>
<dd><p>Calculate longwave sky radiation using Model 3 (advanced anisotropic).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.define_patch_characteristics">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">define_patch_characteristics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solar_altitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solar_azimuth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_altitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_azimuth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steradian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asvf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vegshmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbshvegshmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lsky_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lsky_side</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lsky</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tgwall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ewall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#define_patch_characteristics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.define_patch_characteristics" title="Link to this definition"></a></dt>
<dd><p>Calculate longwave radiation from discretized sky hemisphere patches.</p>
<p>Computes downward and sideward longwave radiation by integrating
contributions from individual sky patches, accounting for their
position, solid angle, shadow state, and temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solar_altitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Solar position (degrees)</p></li>
<li><p><strong>solar_azimuth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Solar position (degrees)</p></li>
<li><p><strong>patch_altitude</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Patch positions</p></li>
<li><p><strong>patch_azimuth</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Patch positions</p></li>
<li><p><strong>steradian</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Solid angle of each patch</p></li>
<li><p><strong>asvf</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Anisotropic sky view factor</p></li>
<li><p><strong>shmat</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow matrices</p></li>
<li><p><strong>vegshmat</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow matrices</p></li>
<li><p><strong>vbshvegshmat</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow matrices</p></li>
<li><p><strong>Lsky_down</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Sky longwave components</p></li>
<li><p><strong>Lsky_side</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Sky longwave components</p></li>
<li><p><strong>Lsky</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Sky longwave components</p></li>
<li><p><strong>Lup</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Upward longwave from ground</p></li>
<li><p><strong>Ta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Air temperature (°C)</p></li>
<li><p><strong>Tgwall</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Wall/ground temperature (K)</p></li>
<li><p><strong>ewall</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Wall emissivity</p></li>
<li><p><strong>rows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Grid dimensions</p></li>
<li><p><strong>cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Grid dimensions</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(Ldown, Lside, Lside_sky, Lside_veg, Lside_sh, Lside_sun,</dt><dd><p>Lside_ref, Least, Lwest, Lnorth, Lsouth) - Longwave components
for downward, sideward (total and directional)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<ul class="simple">
<li><p>Integrates over all sky patches using solid angle weighting</p></li>
<li><p>Accounts for patch visibility through shadow matrices</p></li>
<li><p>Distinguishes between sunlit and shaded patches</p></li>
<li><p>Computes directional components (E, S, W, N)</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.Lcyl_v2022a">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">Lcyl_v2022a</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">esky</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sky_patches</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tgwall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ewall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vegshmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbshvegshmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solar_altitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solar_azimuth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asvf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#Lcyl_v2022a"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.Lcyl_v2022a" title="Link to this definition"></a></dt>
<dd><p>Calculate longwave radiation on cylindrical surface (human body model).</p>
<p>Computes longwave radiation received by a standing person from sky,
ground, and wall surfaces, accounting for shadows and anisotropic effects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>esky</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Sky emissivity</p></li>
<li><p><strong>sky_patches</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Sky hemisphere discretization</p></li>
<li><p><strong>Ta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Air temperature (°C)</p></li>
<li><p><strong>Tgwall</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Wall/ground temperature (K)</p></li>
<li><p><strong>ewall</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Wall emissivity</p></li>
<li><p><strong>Lup</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Upward longwave radiation</p></li>
<li><p><strong>shmat</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow matrices</p></li>
<li><p><strong>vegshmat</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow matrices</p></li>
<li><p><strong>vbshvegshmat</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow matrices</p></li>
<li><p><strong>solar_altitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Solar angles</p></li>
<li><p><strong>solar_azimuth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Solar angles</p></li>
<li><p><strong>rows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Grid dimensions</p></li>
<li><p><strong>cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Grid dimensions</p></li>
<li><p><strong>asvf</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Anisotropic SVF</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(Lsky, Lrefl) - Sky and reflected longwave components</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.Lvikt_veg">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">Lvikt_veg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">svf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfaveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vikttot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#Lvikt_veg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.Lvikt_veg" title="Link to this definition"></a></dt>
<dd><p>Calculate longwave radiation weight factors accounting for vegetation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.Lside_veg_v2022a">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">Lside_veg_v2022a</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">svfS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfW</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfEveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfSveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfWveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfNveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfEaveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfSaveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfWaveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfNaveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azimuth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SBC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ewall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ldown</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esky</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LupE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LupS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LupW</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LupN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anisotropic_longwave</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#Lside_veg_v2022a"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.Lside_veg_v2022a" title="Link to this definition"></a></dt>
<dd><p>Calculate longwave radiation on vertical surfaces (walls) with vegetation effects.</p>
<p>Computes longwave radiation received by walls in the four cardinal directions,
accounting for sky emission, ground emission, wall-to-wall exchanges, and
vegetation obstruction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>svfS</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Directional sky view factors</p></li>
<li><p><strong>svfW</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Directional sky view factors</p></li>
<li><p><strong>svfN</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Directional sky view factors</p></li>
<li><p><strong>svfE</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Directional sky view factors</p></li>
<li><p><strong>svf*veg</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Vegetation-obstructed SVFs</p></li>
<li><p><strong>svf*aveg</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Vegetation-above SVFs</p></li>
<li><p><strong>azimuth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Solar angles (degrees)</p></li>
<li><p><strong>altitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Solar angles (degrees)</p></li>
<li><p><strong>Ta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Air temperature (°C)</p></li>
<li><p><strong>Tw</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Wall temperature</p></li>
<li><p><strong>SBC</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Stefan-Boltzmann constant</p></li>
<li><p><strong>ewall</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Wall emissivity</p></li>
<li><p><strong>Ldown</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Downward longwave</p></li>
<li><p><strong>esky</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Sky emissivity</p></li>
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Time parameter</p></li>
<li><p><strong>F_sh</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow factor</p></li>
<li><p><strong>CI</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Clearness index</p></li>
<li><p><strong>LupE</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Upward longwave per direction</p></li>
<li><p><strong>LupS</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Upward longwave per direction</p></li>
<li><p><strong>LupW</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Upward longwave per direction</p></li>
<li><p><strong>LupN</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Upward longwave per direction</p></li>
<li><p><strong>anisotropic_longwave</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Use anisotropic model</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(Ldown, Lside, Least, Lwest, Lnorth, Lsouth) - Longwave components</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.solweig.Solweig_2022a_calc">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.solweig.</span></span><span class="sig-name descname"><span class="pre">Solweig_2022a_calc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfW</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfNveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfEveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfSveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfWveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfaveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfEaveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfSaveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfWaveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfNaveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vegdem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vegdem2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">albedo_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absK</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ewall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fside</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fcyl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azimuth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jday</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usevegdem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onlyglobal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buildings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landcover</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dectime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirwalls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">walls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cyl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elvis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RH</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radD</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amaxvalue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bush</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Twater</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TgK</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tstart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alb_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emis_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TgK_wall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tstart_wall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TmaxLST</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TmaxLST_wall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfalfa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svfbuveg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">firstdaytime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeadd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestepdec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tgmap1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tgmap1E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tgmap1S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tgmap1W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tgmap1N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TgOut1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffsh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vegshmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbshvegshmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anisotropic_sky</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asvf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_option</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/solweig.html#Solweig_2022a_calc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.solweig.Solweig_2022a_calc" title="Link to this definition"></a></dt>
<dd><p>Main SOLWEIG 2022a calculation kernel - integrates all radiation and temperature calculations.</p>
<p>This is the core GPU-accelerated function that computes:
- Shortwave radiation (direct, diffuse, reflected)
- Longwave radiation (sky, ground, wall emissions)
- Surface energy balance
- Ground and wall surface temperatures
- Mean radiant temperature (Tmrt)</p>
<p>This function is called once per time step and performs the complete
radiation budget calculation accounting for 3D urban geometry, vegetation,
and surface-atmosphere interactions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Time step index</p></li>
<li><p><strong>dsm</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Digital Surface Model</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Grid resolution (pixels/meter)</p></li>
<li><p><strong>rows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Domain dimensions</p></li>
<li><p><strong>cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Domain dimensions</p></li>
<li><p><strong>svf*</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Sky view factors (multiple directional variants)</p></li>
<li><p><strong>vegdem</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Vegetation layers</p></li>
<li><p><strong>vegdem2</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Vegetation layers</p></li>
<li><p><strong>bush</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Vegetation layers</p></li>
<li><p><strong>albedo_b</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Surface optical/thermal properties</p></li>
<li><p><strong>absK</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Surface optical/thermal properties</p></li>
<li><p><strong>absL</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Surface optical/thermal properties</p></li>
<li><p><strong>ewall</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Surface optical/thermal properties</p></li>
<li><p><strong>Fside</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Form factors for different geometries</p></li>
<li><p><strong>Fup</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Form factors for different geometries</p></li>
<li><p><strong>Fcyl</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Form factors for different geometries</p></li>
<li><p><strong>altitude</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Solar geometry</p></li>
<li><p><strong>azimuth</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Solar geometry</p></li>
<li><p><strong>zen</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Solar geometry</p></li>
<li><p><strong>jday</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Temporal parameters</p></li>
<li><p><strong>dectime</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Temporal parameters</p></li>
<li><p><strong>altmax</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Temporal parameters</p></li>
<li><p><strong>usevegdem</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Model configuration flags</p></li>
<li><p><strong>onlyglobal</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Model configuration flags</p></li>
<li><p><strong>buildings</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Building footprint mask</p></li>
<li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Geographic coordinates</p></li>
<li><p><strong>psi</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Tilt angles</p></li>
<li><p><strong>landcover</strong> – Land cover classification</p></li>
<li><p><strong>lc_grid</strong> – Land cover classification</p></li>
<li><p><strong>dirwalls</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Wall geometry</p></li>
<li><p><strong>walls</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Wall geometry</p></li>
<li><p><strong>cyl</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Wall geometry</p></li>
<li><p><strong>elvis</strong> (<em>np.ndarray</em>) – Elevation data</p></li>
<li><p><strong>Ta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Meteorological conditions (air temp, humidity, pressure)</p></li>
<li><p><strong>RH</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Meteorological conditions (air temp, humidity, pressure)</p></li>
<li><p><strong>P</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Meteorological conditions (air temp, humidity, pressure)</p></li>
<li><p><strong>radG</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Incoming radiation components (global, diffuse, direct)</p></li>
<li><p><strong>radD</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Incoming radiation components (global, diffuse, direct)</p></li>
<li><p><strong>radI</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Incoming radiation components (global, diffuse, direct)</p></li>
<li><p><strong>amaxvalue</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Maximum domain elevation</p></li>
<li><p><strong>Twater</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Water surface temperature</p></li>
<li><p><strong>TgK</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Temperature states</p></li>
<li><p><strong>Tstart</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Temperature states</p></li>
<li><p><strong>TgK_wall</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Temperature states</p></li>
<li><p><strong>Tstart_wall</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Temperature states</p></li>
<li><p><strong>TmaxLST</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Maximum temperatures</p></li>
<li><p><strong>TmaxLST_wall</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Maximum temperatures</p></li>
<li><p><strong>alb_grid</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Spatial albedo and emissivity</p></li>
<li><p><strong>emis_grid</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Spatial albedo and emissivity</p></li>
<li><p><strong>first</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Surface type classifications</p></li>
<li><p><strong>second</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Surface type classifications</p></li>
<li><p><strong>svfalfa</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Vegetation view factors</p></li>
<li><p><strong>svfbuveg</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Vegetation view factors</p></li>
<li><p><strong>firstdaytime</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Temporal parameters</p></li>
<li><p><strong>timeadd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Temporal parameters</p></li>
<li><p><strong>timestepdec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Temporal parameters</p></li>
<li><p><strong>Tgmap1</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Previous temperature maps</p></li>
<li><p><strong>Tgmap1E</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Previous temperature maps</p></li>
<li><p><strong>Tgmap1S</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Previous temperature maps</p></li>
<li><p><strong>Tgmap1W</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Previous temperature maps</p></li>
<li><p><strong>Tgmap1N</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Previous temperature maps</p></li>
<li><p><strong>CI</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Clearness index and output temperature</p></li>
<li><p><strong>TgOut1</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Clearness index and output temperature</p></li>
<li><p><strong>diffsh</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow matrices</p></li>
<li><p><strong>shmat</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow matrices</p></li>
<li><p><strong>vegshmat</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow matrices</p></li>
<li><p><strong>vbshvegshmat</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Shadow matrices</p></li>
<li><p><strong>anisotropic_sky</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Use anisotropic sky model</p></li>
<li><p><strong>asvf</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Anisotropic SVF</p></li>
<li><p><strong>patch_option</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Sky discretization option</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(KsideI, TgOut1, TgOut, radIout, radDout, Lside, Lsky_patch, CI_Tg, CI_TgG,</dt><dd><p>KsideD, dRad, Kside) - Comprehensive radiation and temperature outputs</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<ul class="simple">
<li><p>GPU-accelerated for performance</p></li>
<li><p>Most computationally intensive function in SOLWEIG</p></li>
<li><p>Implements surface energy balance with iteration</p></li>
<li><p>Accounts for multiple reflections and anisotropic effects</p></li>
</ul>
</div>
</dd></dl>

</section>
<section id="module-solweig_gpu.sun_position">
<span id="solar-position-algorithm"></span><h2>Solar Position Algorithm<a class="headerlink" href="#module-solweig_gpu.sun_position" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.sun_position">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">sun_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#sun_position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.sun_position" title="Link to this definition"></a></dt>
<dd><p>Calculate solar position (zenith and azimuth) using SPA algorithm.</p>
<p>Implements the Solar Position Algorithm (SPA) as described in:
Reda, I. and Andreas, A. (2004). Solar position algorithm for solar radiation applications.
Solar Energy, 76(5), 577-589.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Time information with keys:
- ‘year’ (int): Year
- ‘month’ (int): Month (1-12)
- ‘day’ (int): Day of month
- ‘hour’ (int): Hour (0-23)
- ‘min’ (int): Minute (0-59)
- ‘sec’ (int): Second (0-59)
- ‘UTC’ (float): UTC offset in hours (e.g., -5 for EST)</p></li>
<li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Geographic location with keys:
- ‘latitude’ (float): Latitude in degrees (-90 to 90)
- ‘longitude’ (float): Longitude in degrees (-180 to 180)
- ‘altitude’ (float): Elevation above sea level in meters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Solar position containing:</dt><dd><ul class="simple">
<li><p>’zenith’ (float): Solar zenith angle in degrees (0=directly overhead, 90=horizon)</p></li>
<li><p>’azimuth’ (float): Solar azimuth in degrees (0=North, 90=East, 180=South, 270=West)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<ul class="simple">
<li><p>Accounts for atmospheric refraction</p></li>
<li><p>Accuracy: ~0.0003° for years 2000-6000</p></li>
<li><p>All angles in degrees unless otherwise specified</p></li>
</ul>
</div>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2020</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;hour&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;sec&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;UTC&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">location</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">30.27</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">97.74</span><span class="p">,</span> <span class="s1">&#39;altitude&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sun</span> <span class="o">=</span> <span class="n">sun_position</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Zenith: </span><span class="si">{</span><span class="n">sun</span><span class="p">[</span><span class="s1">&#39;zenith&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">°, Azimuth: </span><span class="si">{</span><span class="n">sun</span><span class="p">[</span><span class="s1">&#39;azimuth&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">°&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.julian_calculation">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">julian_calculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#julian_calculation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.julian_calculation" title="Link to this definition"></a></dt>
<dd><p>Calculate Julian day and related time parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>t_input</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Time dictionary with year, month, day, hour, min, sec, UTC</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Julian day, century, ephemeris day/century/millennium</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.earth_heliocentric_position_calculation">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">earth_heliocentric_position_calculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">julian</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#earth_heliocentric_position_calculation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.earth_heliocentric_position_calculation" title="Link to this definition"></a></dt>
<dd><p>Calculate Earth’s heliocentric position (longitude, latitude, radius).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>julian</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Julian day parameters</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Earth heliocentric position (longitude, latitude, radius in AU)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.sun_geocentric_position_calculation">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">sun_geocentric_position_calculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">earth_heliocentric_position</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#sun_geocentric_position_calculation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.sun_geocentric_position_calculation" title="Link to this definition"></a></dt>
<dd><p>Calculate geocentric sun position from Earth heliocentric position. SPA Step 3.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.nutation_calculation">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">nutation_calculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">julian</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#nutation_calculation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.nutation_calculation" title="Link to this definition"></a></dt>
<dd><p>Calculate nutation in longitude and obliquity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>julian</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Julian parameters</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nutation in longitude and obliquity (degrees)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.true_obliquity_calculation">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">true_obliquity_calculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">julian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nutation</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#true_obliquity_calculation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.true_obliquity_calculation" title="Link to this definition"></a></dt>
<dd><p>Calculate true obliquity of the ecliptic. SPA Step 5.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.abberation_correction_calculation">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">abberation_correction_calculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">earth_heliocentric_position</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#abberation_correction_calculation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.abberation_correction_calculation" title="Link to this definition"></a></dt>
<dd><p>Calculate aberration correction. SPA Step 6.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.apparent_sun_longitude_calculation">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">apparent_sun_longitude_calculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sun_geocentric_position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nutation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aberration_correction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#apparent_sun_longitude_calculation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.apparent_sun_longitude_calculation" title="Link to this definition"></a></dt>
<dd><p>Calculate apparent sun longitude. SPA Step 7.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.apparent_stime_at_greenwich_calculation">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">apparent_stime_at_greenwich_calculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">julian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nutation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_obliquity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#apparent_stime_at_greenwich_calculation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.apparent_stime_at_greenwich_calculation" title="Link to this definition"></a></dt>
<dd><p>Calculate apparent sidereal time at Greenwich. SPA Step 8.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.sun_rigth_ascension_calculation">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">sun_rigth_ascension_calculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">apparent_sun_longitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_obliquity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_geocentric_position</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#sun_rigth_ascension_calculation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.sun_rigth_ascension_calculation" title="Link to this definition"></a></dt>
<dd><p>Calculate sun right ascension. SPA Step 9.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.sun_geocentric_declination_calculation">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">sun_geocentric_declination_calculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">apparent_sun_longitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_obliquity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_geocentric_position</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#sun_geocentric_declination_calculation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.sun_geocentric_declination_calculation" title="Link to this definition"></a></dt>
<dd><p>Calculate geocentric sun declination. SPA Step 10.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.observer_local_hour_calculation">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">observer_local_hour_calculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">apparent_stime_at_greenwich</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_rigth_ascension</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#observer_local_hour_calculation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.observer_local_hour_calculation" title="Link to this definition"></a></dt>
<dd><p>Calculate observer local hour angle. SPA Step 11.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.topocentric_sun_position_calculate">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">topocentric_sun_position_calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">earth_heliocentric_position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observer_local_hour</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_rigth_ascension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_geocentric_declination</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#topocentric_sun_position_calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.topocentric_sun_position_calculate" title="Link to this definition"></a></dt>
<dd><p>Calculate topocentric sun position. SPA Step 12.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.topocentric_local_hour_calculate">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">topocentric_local_hour_calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observer_local_hour</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topocentric_sun_position</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#topocentric_local_hour_calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.topocentric_local_hour_calculate" title="Link to this definition"></a></dt>
<dd><p>Calculate topocentric local hour angle. SPA Step 13.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.sun_topocentric_zenith_angle_calculate">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">sun_topocentric_zenith_angle_calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topocentric_sun_position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topocentric_local_hour</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#sun_topocentric_zenith_angle_calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.sun_topocentric_zenith_angle_calculate" title="Link to this definition"></a></dt>
<dd><p>Calculate topocentric zenith and azimuth angles with atmospheric refraction. SPA Step 14.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.set_to_range">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">set_to_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_interval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#set_to_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.set_to_range" title="Link to this definition"></a></dt>
<dd><p>Normalize angle to specified range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>var</strong> – Angle value</p></li>
<li><p><strong>min_interval</strong> – Minimum value (typically 0)</p></li>
<li><p><strong>max_interval</strong> – Maximum value (typically 360)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized angle in [min_interval, max_interval)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.sun_position.Solweig_2015a_metdata_noload">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.sun_position.</span></span><span class="sig-name descname"><span class="pre">Solweig_2015a_metdata_noload</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">UTC</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/sun_position.html#Solweig_2015a_metdata_noload"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.sun_position.Solweig_2015a_metdata_noload" title="Link to this definition"></a></dt>
<dd><p>Process meteorological data and calculate solar geometry for each time step.</p>
<p>Computes solar position (altitude, azimuth) for all hours in the met data
and organizes the data for SOLWEIG calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputdata</strong> (<em>np.ndarray</em>) – Meteorological data array</p></li>
<li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Geographic location (latitude, longitude, altitude)</p></li>
<li><p><strong>UTC</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – UTC offset in hours</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(Met, altitude, azimuth, zen, jday, I0, CI, Twater, TgK, Tstart,</dt><dd><p>TgK_wall, Tstart_wall, firstdaytime, timeadd, timestepdec) containing
processed meteorological forcing and solar geometry</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<ul class="simple">
<li><p>Calculates solar position for every time step</p></li>
<li><p>Prepares data for SOLWEIG radiation calculations</p></li>
<li><p>Handles multiple time steps efficiently</p></li>
</ul>
</div>
</dd></dl>

</section>
<section id="module-solweig_gpu.shadow">
<span id="shadow-and-sky-view-factor"></span><h2>Shadow and Sky View Factor<a class="headerlink" href="#module-solweig_gpu.shadow" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.shadow.ensure_tensor">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.shadow.</span></span><span class="sig-name descname"><span class="pre">ensure_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/shadow.html#ensure_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.shadow.ensure_tensor" title="Link to this definition"></a></dt>
<dd><p>Convert input to PyTorch tensor on specified device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Input data (can be numpy array, list, or torch tensor)</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><em>torch.device</em></a><em>, </em><em>optional</em>) – Target device. Auto-detects GPU if available.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Input converted to tensor on specified device</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.shadow.shadow">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.shadow.</span></span><span class="sig-name descname"><span class="pre">shadow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amaxvalue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vegdem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vegdem2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bush</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azimuth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/shadow.html#shadow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.shadow.shadow" title="Link to this definition"></a></dt>
<dd><p>Calculate shadow patterns from buildings and vegetation using GPU-accelerated ray tracing.</p>
<p>This function performs GPU-accelerated shadow calculations by tracing sun rays
across the Digital Surface Model (DSM) accounting for buildings and vegetation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amaxvalue</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Maximum elevation value in the domain</p></li>
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Digital Surface Model (DSM) array</p></li>
<li><p><strong>vegdem</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Vegetation canopy DSM</p></li>
<li><p><strong>vegdem2</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Vegetation trunk zone DSM</p></li>
<li><p><strong>bush</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Bush/shrub layer DSM</p></li>
<li><p><strong>azimuth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Solar azimuth angle (degrees, 0=North, clockwise)</p></li>
<li><p><strong>altitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Solar altitude angle (degrees above horizon)</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Grid resolution in pixels per meter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(sh, vegsh, vbshvegsh) where:</dt><dd><ul class="simple">
<li><p>sh: Shadow map (0=shadow, 1=sunlit)</p></li>
<li><p>vegsh: Vegetation shadow influence</p></li>
<li><p>vbshvegsh: Combined vegetation and building shadow</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<ul class="simple">
<li><p>Automatically uses GPU if available, otherwise CPU</p></li>
<li><p>Implements anisotropic shadow casting</p></li>
<li><p>Accounts for vegetation transmittance</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.shadow.annulus_weight">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.shadow.</span></span><span class="sig-name descname"><span class="pre">annulus_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">altitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aziinterval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/shadow.html#annulus_weight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.shadow.annulus_weight" title="Link to this definition"></a></dt>
<dd><p>Calculate annulus weights for sky view factor computation.</p>
<p>Computes weights for different altitude bands used in SVF calculation
based on the solid angle subtended by each annular ring.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>altitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Solar altitude angle (degrees)</p></li>
<li><p><strong>aziinterval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Azimuthal interval for discretization</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><em>torch.device</em></a><em>, </em><em>optional</em>) – PyTorch device. Auto-detects if None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of annulus weights</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.shadow.create_patches">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.shadow.</span></span><span class="sig-name descname"><span class="pre">create_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_option</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/shadow.html#create_patches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.shadow.create_patches" title="Link to this definition"></a></dt>
<dd><p>Create patch configuration for sky hemisphere discretization.</p>
<p>Generates the angular resolution and patch geometry for sky view factor
calculations by dividing the sky hemisphere into discrete patches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>patch_option</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of patches (144 or 2304)
- 144: Coarser resolution (faster)
- 2304: Finer resolution (more accurate)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Configuration containing:</dt><dd><ul class="simple">
<li><p>’azimuthinterval’: Number of azimuth bins</p></li>
<li><p>’altitudeinterval’: Number of altitude bins</p></li>
<li><p>’patchnorm’: Normalization factor</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If patch_option is not 144 or 2304</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.shadow.svf_calculator">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.shadow.</span></span><span class="sig-name descname"><span class="pre">svf_calculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_option</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amaxvalue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vegdem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vegdem2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bush</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/shadow.html#svf_calculator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.shadow.svf_calculator" title="Link to this definition"></a></dt>
<dd><p>Calculate Sky View Factor (SVF) using GPU-accelerated hemisphere sampling.</p>
<p>SVF represents the portion of visible sky from each point, accounting for
obstructions from buildings and vegetation. Directional SVFs are also computed
for cardinal directions (N, E, S, W).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patch_option</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Sky discretization option (144 or 2304 patches)</p></li>
<li><p><strong>amaxvalue</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Maximum elevation in domain</p></li>
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Digital Surface Model</p></li>
<li><p><strong>vegdem</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Vegetation canopy DSM</p></li>
<li><p><strong>vegdem2</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Vegetation trunk zone DSM</p></li>
<li><p><strong>bush</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Bush layer DSM</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Grid resolution (pixels per meter)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>(svf, svfE, svfS, svfW, svfN, svfveg, svfEveg, svfSveg, svfWveg, svfNveg,</dt><dd><blockquote>
<div><p>svfaveg, svfEaveg, svfSaveg, svfWaveg, svfNaveg) where:</p>
</div></blockquote>
<ul class="simple">
<li><p>svf: Total sky view factor [0-1]</p></li>
<li><p>svfE/S/W/N: Directional SVFs for East/South/West/North</p></li>
<li><p>svf*veg: Vegetation-obstructed SVFs</p></li>
<li><p>svf*aveg: Vegetation-adjusted SVFs</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<ul class="simple">
<li><p>Uses GPU if available for fast computation</p></li>
<li><p>Higher patch_option gives more accurate but slower results</p></li>
<li><p>Directional SVFs useful for anisotropic radiation modeling</p></li>
</ul>
</div>
</dd></dl>

</section>
<section id="module-solweig_gpu.calculate_utci">
<span id="utci-calculations"></span><h2>UTCI Calculations<a class="headerlink" href="#module-solweig_gpu.calculate_utci" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.calculate_utci.utci_polynomial">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.calculate_utci.</span></span><span class="sig-name descname"><span class="pre">utci_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D_Tmrt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">va</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pa</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/calculate_utci.html#utci_polynomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.calculate_utci.utci_polynomial" title="Link to this definition"></a></dt>
<dd><p>Calculate UTCI using 6th order polynomial approximation.</p>
<p>This function implements the UTCI polynomial approximation formula
as defined in the UTCI documentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>D_Tmrt</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Difference between mean radiant temperature and air temperature (K or °C)</p></li>
<li><p><strong>Ta</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Air temperature (°C)</p></li>
<li><p><strong>va</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Wind speed (m/s)</p></li>
<li><p><strong>Pa</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Vapor pressure (kPa)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>UTCI approximation value (°C)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)">torch.Tensor</a></p>
</dd>
</dl>
<div class="admonition-references admonition">
<p class="admonition-title">References</p>
<p>Bröde P, Fiala D, Błażejczyk K, et al. (2012).
Deriving the operational procedure for the Universal Thermal Climate Index (UTCI).
Int J Biometeorol 56:481-494.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.calculate_utci.utci_calculator">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.calculate_utci.</span></span><span class="sig-name descname"><span class="pre">utci_calculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RH</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tmrt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">va10m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/calculate_utci.html#utci_calculator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.calculate_utci.utci_calculator" title="Link to this definition"></a></dt>
<dd><p>Calculate Universal Thermal Climate Index (UTCI) for given meteorological conditions.</p>
<p>UTCI is an international standard for assessing thermal comfort in outdoor environments.
It combines air temperature, mean radiant temperature, wind speed, and humidity into
a single index value that represents the “feels like” temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ta</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Air temperature (°C). Can be scalar or multi-dimensional array.</p></li>
<li><p><strong>RH</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Relative humidity (%). Range: 0-100.</p></li>
<li><p><strong>Tmrt</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Mean radiant temperature (°C). Accounts for solar and thermal radiation.</p></li>
<li><p><strong>va10m</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Wind speed at 10m height (m/s).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>UTCI value (°C). Same shape as input tensors.</dt><dd><p>Returns -999 for invalid input values (Ta, RH, va10m, or Tmrt &lt;= -999).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)">torch.Tensor</a></p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<ul class="simple">
<li><p>UTCI interpretation:
* &lt; 9°C: Strong cold stress
* 9-26°C: Comfortable
* 26-32°C: Moderate heat stress
* &gt; 32°C: Strong heat stress</p></li>
<li><p>All inputs must be torch tensors of the same shape</p></li>
<li><p>Invalid/missing data should be marked as -999</p></li>
</ul>
</div>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">25.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rh</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">50.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmrt</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">30.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wind</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">utci</span> <span class="o">=</span> <span class="n">utci_calculator</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">tmrt</span><span class="p">,</span> <span class="n">wind</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;UTCI: </span><span class="si">{</span><span class="n">utci</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">°C&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition-references admonition">
<p class="admonition-title">References</p>
<p>Bröde P, Fiala D, Błażejczyk K, et al. (2012).
Deriving the operational procedure for the Universal Thermal Climate Index (UTCI).
Int J Biometeorol 56:481-494.</p>
</div>
</dd></dl>

</section>
<section id="module-solweig_gpu.utci_process">
<span id="utci-processing"></span><h2>UTCI Processing<a class="headerlink" href="#module-solweig_gpu.utci_process" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.utci_process.load_raster_to_tensor">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.utci_process.</span></span><span class="sig-name descname"><span class="pre">load_raster_to_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dem_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/utci_process.html#load_raster_to_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.utci_process.load_raster_to_tensor" title="Link to this definition"></a></dt>
<dd><p>Load a GeoTIFF raster file into a PyTorch tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dem_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to GeoTIFF file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(tensor, dataset) where:</dt><dd><ul class="simple">
<li><p>tensor: PyTorch tensor on GPU/CPU with raster data</p></li>
<li><p>dataset: GDAL dataset object (for accessing metadata)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.utci_process.extract_key">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.utci_process.</span></span><span class="sig-name descname"><span class="pre">extract_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_metfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/utci_process.html#extract_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.utci_process.extract_key" title="Link to this definition"></a></dt>
<dd><p>Extract numerical key from filename for tile matching.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Filename to parse</p></li>
<li><p><strong>is_metfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – True if filename is a metfile, False if raster tile</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Extracted key (e.g., “0_0” from “Building_DSM_0_0.tif”)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.utci_process.get_matching_files">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.utci_process.</span></span><span class="sig-name descname"><span class="pre">get_matching_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extension</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/utci_process.html#get_matching_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.utci_process.get_matching_files" title="Link to this definition"></a></dt>
<dd><p>Get sorted list of files with given extension from directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directory</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Directory path to search</p></li>
<li><p><strong>extension</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – File extension to filter (e.g., ‘.tif’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sorted list of filenames matching extension</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.utci_process.map_files_by_key">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.utci_process.</span></span><span class="sig-name descname"><span class="pre">map_files_by_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_metfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/utci_process.html#map_files_by_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.utci_process.map_files_by_key" title="Link to this definition"></a></dt>
<dd><p>Create mapping of tile keys to filenames.</p>
<p>Groups files by their tile coordinates (e.g., “0_0”, “1000_0”) to match
corresponding raster tiles with their meteorological files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directory</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Directory containing files</p></li>
<li><p><strong>extension</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – File extension to filter</p></li>
<li><p><strong>is_metfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – True if files are metfiles</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping keys to filenames</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.utci_process.extract_number_from_filename">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.utci_process.</span></span><span class="sig-name descname"><span class="pre">extract_number_from_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/utci_process.html#extract_number_from_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.utci_process.extract_number_from_filename" title="Link to this definition"></a></dt>
<dd><p>Extract tile number from Building_DSM filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Filename in format “Building_DSM_X_Y.tif”</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Extracted number portion (e.g., “0_0”)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.utci_process.compute_utci">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.utci_process.</span></span><span class="sig-name descname"><span class="pre">compute_utci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">building_dsm_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dem_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">walls_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landcover_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">met_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_date_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_tmrt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_svf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_kup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_kdown</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_lup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_ldown</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_shadow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/utci_process.html#compute_utci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.utci_process.compute_utci" title="Link to this definition"></a></dt>
<dd><p>Compute UTCI and related thermal comfort outputs for a single tile.</p>
<p>This is the main computation function that integrates shadow modeling, radiation
calculations, and UTCI computation for urban microclimate analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>building_dsm_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to Building DSM raster</p></li>
<li><p><strong>tree_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to tree/vegetation DSM raster</p></li>
<li><p><strong>dem_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to Digital Elevation Model raster</p></li>
<li><p><strong>walls_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to wall height raster</p></li>
<li><p><strong>aspect_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to wall aspect raster</p></li>
<li><p><strong>landcover_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to land cover raster (can be None)</p></li>
<li><p><strong>met_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to meteorological forcing file</p></li>
<li><p><strong>output_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Directory for saving output rasters</p></li>
<li><p><strong>number</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Tile identifier (e.g., “0_0”)</p></li>
<li><p><strong>selected_date_str</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Date string (YYYY-MM-DD)</p></li>
<li><p><strong>save_tmrt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Save mean radiant temperature output</p></li>
<li><p><strong>save_svf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Save sky view factor output</p></li>
<li><p><strong>save_kup</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Save upward shortwave radiation</p></li>
<li><p><strong>save_kdown</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Save downward shortwave radiation</p></li>
<li><p><strong>save_lup</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Save upward longwave radiation</p></li>
<li><p><strong>save_ldown</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Save downward longwave radiation</p></li>
<li><p><strong>save_shadow</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Save shadow maps</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Outputs are saved as GeoTIFF files in output_path</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<ul class="simple">
<li><p>Automatically uses GPU if available</p></li>
<li><p>Outputs are multi-band rasters (one band per hour)</p></li>
<li><p>UTCI is always computed and saved</p></li>
<li><p>Other outputs are optional based on save_* flags</p></li>
</ul>
</div>
</dd></dl>

</section>
<section id="module-solweig_gpu.walls_aspect">
<span id="wall-geometry"></span><h2>Wall Geometry<a class="headerlink" href="#module-solweig_gpu.walls_aspect" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.walls_aspect.findwalls">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.walls_aspect.</span></span><span class="sig-name descname"><span class="pre">findwalls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dem_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">walllimit</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/walls_aspect.html#findwalls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.walls_aspect.findwalls" title="Link to this definition"></a></dt>
<dd><p>Identify walls in a Digital Surface Model (DSM) based on height threshold.</p>
<p>Walls are detected by comparing each cell to its immediate neighbors.
A wall exists where the elevation difference exceeds the threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dem_array</strong> (<em>np.ndarray</em>) – 2D array of elevation values (DSM)</p></li>
<li><p><strong>walllimit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Minimum height difference (m) to be considered a wall</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D array of wall heights. Zero where no wall exists.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.walls_aspect.cart2pol">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.walls_aspect.</span></span><span class="sig-name descname"><span class="pre">cart2pol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'deg'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/walls_aspect.html#cart2pol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.walls_aspect.cart2pol" title="Link to this definition"></a></dt>
<dd><p>Convert Cartesian coordinates to polar coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – X coordinate(s)</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Y coordinate(s)</p></li>
<li><p><strong>units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Output angle units (‘deg’ or ‘rad’). Default: ‘deg’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(theta, radius) where theta is angle and radius is distance</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.walls_aspect.get_ders">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.walls_aspect.</span></span><span class="sig-name descname"><span class="pre">get_ders</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/walls_aspect.html#get_ders"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.walls_aspect.get_ders" title="Link to this definition"></a></dt>
<dd><p>Calculate slope derivatives (aspect and gradient) from DSM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsm</strong> (<em>np.ndarray</em>) – Digital Surface Model array</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Pixel size in meters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(aspect, gradient) where:</dt><dd><ul class="simple">
<li><p>aspect: slope orientation in radians</p></li>
<li><p>gradient: slope magnitude</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.walls_aspect.filter1Goodwin_as_aspect_v3">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.walls_aspect.</span></span><span class="sig-name descname"><span class="pre">filter1Goodwin_as_aspect_v3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">walls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/walls_aspect.html#filter1Goodwin_as_aspect_v3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.walls_aspect.filter1Goodwin_as_aspect_v3" title="Link to this definition"></a></dt>
<dd><p>Calculate wall aspect (orientation) using directional filtering.</p>
<p>This function determines the orientation of walls by rotating a directional
filter and finding the direction with maximum wall presence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>walls</strong> (<em>np.ndarray</em>) – Binary array indicating wall locations</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Pixel size in meters</p></li>
<li><p><strong>a</strong> (<em>np.ndarray</em>) – Aspect array from DSM derivatives</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Wall aspect in degrees [0-360], where 0=North, 90=East, 180=South, 270=West</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.walls_aspect.process_file_parallel">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.walls_aspect.</span></span><span class="sig-name descname"><span class="pre">process_file_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/walls_aspect.html#process_file_parallel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.walls_aspect.process_file_parallel" title="Link to this definition"></a></dt>
<dd><p>Process a single DEM tile to calculate walls and aspect (parallel worker function).</p>
<p>This function is designed to be called by parallel processing workers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – (filename, dem_folder_path, wall_output_path, aspect_output_path)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filename of processed tile</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.walls_aspect.run_parallel_processing">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.walls_aspect.</span></span><span class="sig-name descname"><span class="pre">run_parallel_processing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dem_folder_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wall_output_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect_output_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/walls_aspect.html#run_parallel_processing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.walls_aspect.run_parallel_processing" title="Link to this definition"></a></dt>
<dd><p>Process all DEM tiles in parallel to calculate walls and aspects.</p>
<p>This is the main entry point for wall and aspect calculation. It uses
multiprocessing to process multiple tiles simultaneously for efficiency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dem_folder_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to folder containing DEM tile GeoTIFFs</p></li>
<li><p><strong>wall_output_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Output path for wall height rasters</p></li>
<li><p><strong>aspect_output_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Output path for wall aspect rasters</p></li>
</ul>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<ul class="simple">
<li><p>Uses all available CPU cores minus one</p></li>
<li><p>Progress bar shows processing status</p></li>
<li><p>Creates output directories if they don’t exist</p></li>
<li><p>Skips tiles that cannot be opened or have invalid data</p></li>
</ul>
</div>
</dd></dl>

</section>
<section id="module-solweig_gpu.cli">
<span id="command-line-interface"></span><h2>Command-Line Interface<a class="headerlink" href="#module-solweig_gpu.cli" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.cli.str2bool">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.cli.</span></span><span class="sig-name descname"><span class="pre">str2bool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/cli.html#str2bool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.cli.str2bool" title="Link to this definition"></a></dt>
<dd><p>Convert string to boolean for argparse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>v</strong> – Input value (str or bool)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted boolean value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)">bool</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/argparse.html#argparse.ArgumentTypeError" title="(in Python v3.14)"><strong>argparse.ArgumentTypeError</strong></a> – If value cannot be converted to boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.cli.main">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.cli.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/cli.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.cli.main" title="Link to this definition"></a></dt>
<dd><p>Command-line interface for SOLWEIG-GPU thermal comfort modeling.</p>
<p>Parses command-line arguments and runs the thermal_comfort function.
This is the entry point for the ‘thermal_comfort’ console script.</p>
<dl class="simple">
<dt>Usage:</dt><dd><p>thermal_comfort –base_path /path/to/input –date 2020-08-13 [options]</p>
</dd>
<dt>For full help:</dt><dd><p>thermal_comfort –help</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-solweig_gpu.Tgmaps_v1">
<span id="surface-properties"></span><h2>Surface Properties<a class="headerlink" href="#module-solweig_gpu.Tgmaps_v1" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="solweig_gpu.Tgmaps_v1.Tgmaps_v1">
<span class="sig-prename descclassname"><span class="pre">solweig_gpu.Tgmaps_v1.</span></span><span class="sig-name descname"><span class="pre">Tgmaps_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc_class</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/solweig_gpu/Tgmaps_v1.html#Tgmaps_v1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solweig_gpu.Tgmaps_v1.Tgmaps_v1" title="Link to this definition"></a></dt>
<dd><p>Populate surface property grids from land cover classification.</p>
<p>Maps land cover classes to their corresponding thermal and optical properties
for ground temperature wave calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lc_grid</strong> (<em>np.ndarray</em>) – Land cover classification grid</p></li>
<li><p><strong>lc_class</strong> (<em>np.ndarray</em>) – Land cover lookup table with columns:
[class_id, albedo, emissivity, TgK, Tstart, TmaxLST]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(TgK, Tstart, alb_grid, emis_grid, TgK_wall, Tstart_wall,</dt><dd><p>TmaxLST, TmaxLST_wall) - Surface property grids and wall parameters</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Quick Start Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="input_data.html" class="btn btn-neutral float-right" title="Input Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2025, Harsh Kamath and Naveen Sudharsan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>